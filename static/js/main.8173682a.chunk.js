(this["webpackJsonpwebrtc-example"]=this["webpackJsonpwebrtc-example"]||[]).push([[0],{30:function(e,n,t){e.exports=t(74)},35:function(e,n,t){},36:function(e,n,t){},69:function(e,n){},74:function(e,n,t){"use strict";t.r(n);var o=t(0),c=t.n(o),i=t(28),a=t.n(i),r=(t(35),t(13)),s=(t(36),t(29)),l=t.n(s),u=function(){var e=Object(o.useState)(),n=Object(r.a)(e,2),t=(n[0],n[1]),i=Object(o.useState)(),a=Object(r.a)(i,2),s=(a[0],a[1]),u=Object(o.useRef)(null),d=Object(o.useRef)(null),f={iceServers:[{urls:"stun:stun.l.google.com:19302"}]};return Object(o.useEffect)((function(){var e=l.a.connect("https://rchatting.shop"),n=new RTCPeerConnection(f);e.on("all_users",(function(e){e.length>0&&o()})),e.on("getOffer",(function(e){console.log("get offer"),c(e)})),e.on("getAnswer",(function(e){console.log("get answer"),n.setRemoteDescription(new RTCSessionDescription(e))})),e.on("getCandidate",(function(e){n.addIceCandidate(new RTCIceCandidate(e)).then((function(){console.log("candidate add success")}))})),s(e),t(n),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){u.current&&(u.current.srcObject=t),t.getTracks().forEach((function(e){n.addTrack(e,t)})),n.onicecandidate=function(n){n.candidate&&(console.log("onicecandidate"),e.emit("candidate",n.candidate))},n.oniceconnectionstatechange=function(e){console.log(e)},n.ontrack=function(e){console.log("add remotetrack success"),d.current&&(d.current.srcObject=e.streams[0])},e.emit("join_room",{room:"1234",email:"sample@naver.com"})})).catch((function(e){console.log("getUserMedia error: ".concat(e))}));var o=function(){console.log("create offer"),n.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0}).then((function(t){n.setLocalDescription(new RTCSessionDescription(t)),e.emit("offer",t)})).catch((function(e){console.log(e)}))},c=function(t){n.setRemoteDescription(new RTCSessionDescription(t)).then((function(){console.log("answer set remote description success"),n.createAnswer({offerToReceiveVideo:!0,offerToReceiveAudio:!0}).then((function(t){console.log("create answer"),n.setLocalDescription(new RTCSessionDescription(t)),e.emit("answer",t)})).catch((function(e){console.log(e)}))}))}}),[]),c.a.createElement("div",null,c.a.createElement("video",{style:{width:240,height:240,margin:5,backgroundColor:"black"},muted:!0,ref:u,autoPlay:!0}),c.a.createElement("video",{id:"remotevideo",style:{width:240,height:240,margin:5,backgroundColor:"black"},ref:d,autoPlay:!0}))};a.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(u,null)),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.8173682a.chunk.js.map